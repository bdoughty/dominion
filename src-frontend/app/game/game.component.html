<div id="game">
  <div id="board" *ngIf="game">
    <div id="left-bar">
      <div id="stats">
        <div class="stat">
          <span class="stat-label">Actions:</span> {{ game.actions }}
        </div>
        <div class="stat">
          <span class="stat-label">Buys:</span> {{ game.buys }}
        </div>
        <div class="stat">
          <span class="stat-label">Gold:</span> {{ game.gold }}
        </div>
      </div>
      <div id="cart" [ngClass]="{hidden: !shouldDisplayCart()}">
        <div class="cart-inner">
          <dmn-card *ngFor="let card of game.cart"
                    [card]="card"
                    (click)="game.removeFromCart(card)">

          </dmn-card>
        </div>
      </div>
      <button *ngIf="game.isSelecting && game.toSelectStoppable && !game.isOver"
              (click)="endSelecting()">End Select</button>
      <button *ngIf="!(game.isSelecting && game.toSelectStoppable) && !game.isOver"
              [ngClass]="{hidden: game.isSelecting || !game.isOwnTurn()}"
              (click)="endPhase()">End {{ game.phase }} Phase</button>
    </div>
    <div id="piles">

      <div class="pile-row">
        <dmn-card [card]="card"
                  [disabled]="card.pileCount == 0 || !game.canBuy(card) && !game.isSelectable(card, false)"
                  [selectable]="game.isSelectable(card, false)"
                  *ngFor="let card of game.nonactionCards"
                  (click)="cardClickedPile(card)"
        >
        </dmn-card>
      </div>
      <div class="pile-row">
        <dmn-card [card]="card"
                  [disabled]="card.pileCount == 0 || !game.canBuy(card) && !game.isSelectable(card, false)"
                  [selectable]="game.isSelectable(card, false)"
                  *ngFor="let card of game.actionCards.slice(0, 6)"
                  (click)="cardClickedPile(card)"
        >
        </dmn-card>
      </div>
      <div class="pile-row">
        <dmn-card [card]="card"
                  [disabled]="card.pileCount == 0 || !game.canBuy(card) && !game.isSelectable(card, false)"
                  [selectable]="game.isSelectable(card, false)"
                  *ngFor="let card of game.actionCards.slice(6, 12)"
                  (click)="cardClickedPile(card)"
        >
        </dmn-card>
      </div>
    </div>
    <div id="right-bar-container">
      <div id="right-bar">
        <div class="turns">
          <div *ngFor="let player of game.orderedPlayers; let i = index;"
               class="turn" [ngClass]="{currentTurn: i === 0}">
            <div class="current-turn-message">Current Turn</div>
            <div class="turn-info">
              <div class="name">{{player.name}}</div>
              <div class="num-cards">{{ player.numCards }} Cards, {{ player.victoryPoints }} VP</div>
            </div>
          </div>
          <div class="chat-container">
            <dmn-chat [endpoint]="'game'" [socket]="_gameSocketService"></dmn-chat>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="hud" *ngIf="game">
    <div class="left">
      <div class="discard">
        <dmn-card [count]="game.discardsize"></dmn-card>
      </div>
    </div>
    <div class="hand-container">
      <div class="hand">
        <dmn-card *ngFor="let card of game.hand"
                  (click)="cardClickedHand(card)"
                  [disabled]="!(game.toSelectHand.indexOf(card.id) !== -1 || game.canPlay(card))"
                  [selectable]="game.isSelectable(card, true)"
                  [card]="card"
                  [@cardState]="card.state"></dmn-card>
      </div>
    </div>
    <div class="deck">
      <dmn-card [count]="game.decksize"></dmn-card>
    </div>
  </div>
</div>

